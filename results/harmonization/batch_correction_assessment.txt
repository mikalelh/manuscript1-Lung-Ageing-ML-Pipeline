Batch correction performance assessment
==================================================

1. BATCH MIXING (technical variation removed)
----------------------------------------
  • Silhouette (batch):     0.0528  → lower is better (batch should not separate cells)
  • Graph connectivity:     0.9273  → fraction of cells in largest cross-batch component (higher = better mix)
  • Mixing score:           0.2994  → 1 - mean(same-batch k-NN fraction); higher = more mixed neighborhoods
  • k-NN same-batch mean:   0.7006  → lower = more cross-batch neighbors

2. BIOLOGY PRESERVATION (cell types still separable)
----------------------------------------
  • Silhouette (cell type): 0.1130  → higher is better (cell types should still cluster)
  • ARI (Leiden vs labels): 0.6463  → agreement of clustering with cell types (higher = better)
  • NMI (Leiden vs labels): 0.8057  → mutual information (higher = better)
  • Mean cluster entropy:   0.8512  → batch diversity within clusters (higher = more mixed)

3. SAMPLE
----------------------------------------
  n_cells = 45287, n_batches = 2, n_cell_types = 34

4. ASSESSMENT OF ALL STATS AND DEDUCTIONS
==================================================

  Batch silhouette (0.0528):
    → Deduction: Batch identity is poorly predictive of position; technical batch effect has been successfully reduced.

  Graph connectivity (0.9273):
    → Deduction: Most cells are connected via cross-batch edges; batches are well mixed in local neighborhoods.

  Mixing score (0.2994):
    → Deduction: Moderate mixing; roughly 20–40% of neighbors are from the other batch.

  Cell-type silhouette (0.1130):
    → Deduction: Cell types remain well separated; biological signal has been preserved.

  ARI (0.6463) and NMI (0.8057):
    → Deduction: Leiden clusters align well with annotated cell types; biology is retained in the embedding.

  OVERALL VERDICT:
    Batch mixing: GOOD – batches are well integrated.
    Biology: PRESERVED – cell-type structure retained.
